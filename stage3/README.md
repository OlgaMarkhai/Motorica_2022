# Motorica_2022  - этап 3
# The task of gesture classification  - Задача классификации жестов

**Команда № 5**  
**Состав команды:**  

- Власов Владимир https://github.com/vip-v2a
- Мархай Ольга https://github.com/OlgaMarkhai
- Плюснин Олег https://github.com/cheef777/SkillFactory
- Ядринцев Алексей https://github.com/Yyalexx

**Описание задачи 3 этапа:**  

Текущая постановка задачи:

- собраны данные от 3х разных "пилотов" (2 из которых пришли на экскурсию от Скиллфактори в офис Моторики), для участников будет размеченно, какие данные относятся к какому пилоту;  
- вместо обучающей выборки из наблюдений участникам предоставляется непрерывный массив OMG-данных и соответствующий массив с целевой переменной;
количество уникальных жестов уменьшено;  
- наблюдения в тестовых OMG-данные из себя представляют временные отрезки переменной длины, внутри которых могут совершаться жесты (один и больше), а могут и не совершаться жесты вообще;  

**Описание данных:**  

Данные представляют из себя временные ряды, где в каждый момент времени фиксируются показания от датчиков.
Целевая переменная представляет из себя маску команды выполняемого пользователем жеста в каждый момент времени.

X_train.npy - обучающая выборка;  
y_train.csv - маска выполнения жеста для обучающей выборки;  
X_test.npy - тестовая выборка;  
sample_submission.csv - некоторое решение задачи из которого можно взять формат;  

X_train.npy и X_test.npy имеют следующие размерности (наблюдения, датчики, время);  
y_train.csv и y_test.csv имеют следующие размерности (наблюдения * время) - это обусловленно форматом ответов для Kaggle;  

Количество уникальных жестов уменьшено, набор уникальных жестов следующий:

1 - потенциально "битые" данные;    
0 - команда "жест open";    
1 - команда "жест пистолет";    
2 - команда "сгиб большого пальца";    
3 - команда "жест ОК";    
4 - команда "жест grab";    

### Описание проделанной работы

Первоначально была произведена обработка целевой переменной, переопределена координата смены класса с использованием функции diff, переразмечен y_train c использованием списка координат смены класса для наблюдений.

Первый вариант решения задачи  - с помощью нейронной сети Keras представлен в файле **add_3_fin.ipynb**. В качестве y_train мы взяли свою разметку, в которой переход класса определяется по максимальному изменению показаний одного из 16 датчиков. После обучения модели была сделана постобработка для сглаживания неоднозначности определения выполненной пользователем команды. Мы использовали сглаживание sbmission модой с окном 7. Данное значение было определено экспериментальным путём. 
Тренировка модели проходит в несколько этапов:  
- Обучение 25 эпох с learning_rate=1e-3.
- Дообучение модели 2 раза по 10 эпох с learning_rate=1e-4.      

Кросс-валидация на нейронных сетях занимает около получаса времени.  
Данное решение имело score 0.98703, обученная модель представлена в файле **score98703.h5**.

Второй вариант решения задачи - последовательно применим к нашим данным две модели машинного обучения, файл **2_logreg_mode-CV-1.ipynb**. Первая модель logistic regression, будет выполнять бинарную классификацию и определять был ли осуществлен жест или нет. Если жест был сделан, то мы применяем к таким жестам вторую модель многоклассовой классификации logistic regression, которая уже в свою очередь классифицирует жест по виду. 

Score у данного решения  - 0.97407.

Для обучения модели на новых данных был написан скрипт **my_script_2.py**. На вход модели подается массив формата (N, 40, 100), где N количество жестов, на выходе имеем массив **y** формата (N, 100) и одномерный массив **y_flat** формата (N*100).  Данный скрипт делает предсказание на основе модели из файла **score98703.h5**.

Также в директории содержится два файла разметки y_train:  **y_train_250_5_61_-2.csv** и **y_train_250_5_61_-2.csv** со сдвигами -2 и -3 соответственно.

### Выводы
Наибольший score был получен при решении с нейронной сетью - 0.98703.  

Для распознавания команд, которые выполнялись пользователем, были применены модели машинного обучения, которые решали задачу классификации.  

Основной задачей стало правильная разметка целевой переменной, что позволило качественно обучить модели. Также наилучшей метрики позволила достичь постобработка submission с помощью mode.  

Данные модели обеспечивают достаточно хорошую классификацию команд пользователей.  


